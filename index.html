<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="theme-color" content="#007bff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>Badminton Player Group Randomizer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .card {
            border-radius: 15px;
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .card-header {
            border-radius: 15px 15px 0 0 !important;
            font-weight: bold;
        }
        .btn-primary {
            border-radius: 25px;
            padding: 10px 30px;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        .skill-beginner { background-color: #28a745; }
        .skill-intermediate { background-color: #ffc107; color: #212529; }
        .skill-advanced { background-color: #dc3545; }
        .form-check { margin-bottom: 0.5rem; }
        .form-check-label { cursor: pointer; }
        .form-check-input { transform: scale(1.2); margin-right: 0.5rem; }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .card { margin: 10px 0; }
            .card-header h1 { font-size: 1.5rem; }
            .btn-primary { padding: 12px 20px; font-size: 1rem; width: 100%; margin-bottom: 10px; }
            .btn-outline-secondary { padding: 8px 16px; font-size: 0.9rem; }
            .form-check { padding: 8px; margin-bottom: 8px; }
            .form-check-label { font-size: 1rem; padding: 5px 0; }
            .table-responsive { font-size: 0.9rem; }
            .badge { font-size: 0.75rem; padding: 0.4em 0.6em; }
            .col-md-4 { margin-bottom: 15px; }
            h4 { font-size: 1.2rem; }
            h6 { font-size: 1rem; }
            .text-muted { font-size: 0.85rem; }
        }

        @media (max-width: 480px) {
            .card-header h1 { font-size: 1.3rem; }
            .container { padding: 5px; }
            .row { margin: 0; }
            .col-md-4 { padding: 5px; }
            .form-check-label { font-size: 0.95rem; }
            .table { font-size: 0.8rem; }
            .btn-primary { padding: 15px 20px; font-size: 1.1rem; }
        }
    </style>
</head>
<body>
    <div class="container-fluid px-2 px-md-3 mt-3 mt-md-5">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white text-center">
                        <h1 class="mb-0">üèì Badminton Player Group Randomizer</h1>
                    </div>
                    <div class="card-body">
                        <p class="text-center mb-4">
                            This app randomizes players into groups of 4.<br>
                            Groups consist of: <strong>Beginner+Intermediate</strong> OR <strong>Intermediate+Advanced</strong><br>
                            <span class="text-danger">Never: Beginner+Advanced</span>
                        </p>

                        <!-- Players Info -->
                        <div class="row text-center mb-4">
                            <div class="col-md-4">
                                <div class="badge bg-success fs-6 p-2">Beginners: 4</div>
                            </div>
                            <div class="col-md-4">
                                <div class="badge bg-warning fs-6 p-2">Intermediates: 10</div>
                            </div>
                            <div class="col-md-4">
                                <div class="badge bg-danger fs-6 p-2">Advanced: 5</div>
                            </div>
                        </div>

                        <!-- Present Players Selection -->
                        <div class="mb-4">
                            <h4 class="text-center mb-3">Select Present Players</h4>
                            <p class="text-center text-muted small mb-3">Check the boxes for players who ARE present</p>
                            <div class="row g-2 g-md-3">
                                <div class="col-12 col-sm-6 col-md-4">
                                    <div class="border rounded p-3 bg-light">
                                        <h6 class="text-success text-center mb-3">Beginners</h6>
                                        <div id="beginnersCheckboxes">
                                            <!-- Beginner checkboxes will be inserted here -->
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-sm-6 col-md-4">
                                    <div class="border rounded p-3 bg-light">
                                        <h6 class="text-warning text-center mb-3">Intermediates</h6>
                                        <div id="intermediatesCheckboxes">
                                            <!-- Intermediate checkboxes will be inserted here -->
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-sm-6 col-md-4">
                                    <div class="border rounded p-3 bg-light">
                                        <h6 class="text-danger text-center mb-3">Advanced</h6>
                                        <div id="advancedCheckboxes">
                                            <!-- Advanced checkboxes will be inserted here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="text-center mt-3">
                                <div class="btn-group d-block d-sm-inline-block" role="group">
                                    <button onclick="selectAll()" class="btn btn-outline-secondary btn-sm me-1 me-sm-2">Select All</button>
                                    <button onclick="selectNone()" class="btn btn-outline-secondary btn-sm">Select None</button>
                                </div>
                            </div>
                        </div>
                        <div class="text-center mb-4">
                            <button onclick="randomizeGroups()" class="btn btn-primary btn-lg w-100">üé≤ Randomize Groups</button>
                        </div>

                        <!-- Groups Display -->
                        <div id="groupsContainer" class="mt-5" style="display: none;">
                            <h2 class="text-center mb-4">Generated Groups</h2>
                            <div class="row g-3">
                                <!-- Groups will be inserted here -->
                            </div>
                        </div>

                        <!-- All Players List -->
                        <div class="mt-5">
                            <h3 class="text-center mb-3">All Players</h3>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover table-sm">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>Name</th>
                                            <th>Skill</th>
                                            <th class="d-none d-sm-table-cell">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="playersTable">
                                        <!-- Players will be inserted here -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="d-block d-sm-none mt-2">
                                <small class="text-muted">Tap player names to see status</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Player data
        const allPlayers = [
            // Beginners
            { name: "Balaji", skill: "BEGINNER" },
            { name: "Anand(Forever in our memories)", skill: "BEGINNER" },
            { name: "Prakash", skill: "BEGINNER" },
            { name: "Sree", skill: "BEGINNER" },
            // Intermediates
            { name: "Arun", skill: "INTERMEDIATE" },
            { name: "Dileep", skill: "INTERMEDIATE" },
            { name: "Bheesh", skill: "INTERMEDIATE" },
            { name: "Kirshnamurthy", skill: "INTERMEDIATE" },
            { name: "Joseph", skill: "INTERMEDIATE" },
            { name: "Hashim", skill: "INTERMEDIATE" },
            { name: "Santhosh", skill: "INTERMEDIATE" },
            { name: "Sudha", skill: "INTERMEDIATE" },
            { name: "Suren", skill: "INTERMEDIATE" },
            { name: "Kripa", skill: "INTERMEDIATE" },
            // Advanced
            { name: "Charles", skill: "ADVANCED" },
            { name: "Faizee", skill: "ADVANCED" },
            { name: "Raaju", skill: "ADVANCED" },
            { name: "Arvind", skill: "ADVANCED" },
            { name: "Raja", skill: "ADVANCED" }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            displayPlayerCheckboxes();
            displayAllPlayers();
        });

        function displayPlayerCheckboxes() {
            const beginnersDiv = document.getElementById('beginnersCheckboxes');
            const intermediatesDiv = document.getElementById('intermediatesCheckboxes');
            const advancedDiv = document.getElementById('advancedCheckboxes');

            beginnersDiv.innerHTML = '';
            intermediatesDiv.innerHTML = '';
            advancedDiv.innerHTML = '';

            allPlayers.forEach(player => {
                const checkboxDiv = document.createElement('div');
                checkboxDiv.className = 'form-check';
                checkboxDiv.innerHTML = `
                    <input class="form-check-input" type="checkbox" id="check-${player.name}" onchange="updatePlayerTable()">
                    <label class="form-check-label" for="check-${player.name}">
                        ${player.name}
                    </label>
                `;

                if (player.skill === 'BEGINNER') {
                    beginnersDiv.appendChild(checkboxDiv);
                } else if (player.skill === 'INTERMEDIATE') {
                    intermediatesDiv.appendChild(checkboxDiv);
                } else {
                    advancedDiv.appendChild(checkboxDiv);
                }
            });
        }

        function selectAll() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = true);
            updatePlayerTable();
        }

        function selectNone() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = false);
            updatePlayerTable();
        }

        function updatePlayerTable() {
            displayAllPlayers();
        }

        function displayAllPlayers() {
            const tbody = document.getElementById('playersTable');
            tbody.innerHTML = '';

            allPlayers.forEach(player => {
                const checkbox = document.getElementById(`check-${player.name}`);
                const isPresent = checkbox ? checkbox.checked : false;

                const row = document.createElement('tr');
                row.className = isPresent ? '' : 'table-secondary';
                row.innerHTML = `
                    <td>${player.name}</td>
                    <td><span class="badge skill-${player.skill.toLowerCase()}">${player.skill}</span></td>
                    <td class="d-none d-sm-table-cell"><span class="badge ${isPresent ? 'bg-success' : 'bg-secondary'}">${isPresent ? 'Present' : 'Absent'}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        function randomizeGroups() {
            // Get present players from checkboxes
            const presentPlayers = allPlayers.filter(player => {
                const checkbox = document.getElementById(`check-${player.name}`);
                return checkbox && checkbox.checked;
            });

            // Update table display
            displayAllPlayers();

            // Randomize groups
            const groups = randomizePlayers(presentPlayers);

            // Display groups
            displayGroups(groups);
        }

        function displayGroups(groups) {
            const container = document.getElementById('groupsContainer');
            const groupsRow = container.querySelector('.row');

            groupsRow.innerHTML = '';

            groups.forEach(group => {
                const col = document.createElement('div');
                col.className = 'col-12 col-md-6 mb-3';

                const cardClass = group.isForced ? 'border-warning' : 'border-primary';
                const headerClass = group.isForced ? 'bg-warning' : 'bg-primary text-white';

                let teamsHtml = '';
                if (group.players.length === 4 && group.team1 && group.team2) {
                    teamsHtml = `
                        <div class="row g-2 mt-2">
                            <div class="col-6">
                                <div class="card bg-light border-0">
                                    <div class="card-body text-center p-2">
                                        <h6 class="mb-2">Team 1</h6>
                                        <div class="small">${group.team1.players.map(p => p.name).join('<br>')}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="card bg-light border-0">
                                    <div class="card-body text-center p-2">
                                        <h6 class="mb-2">Team 2</h6>
                                        <div class="small">${group.team2.players.map(p => p.name).join('<br>')}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }

                col.innerHTML = `
                    <div class="card ${cardClass} h-100">
                        <div class="card-header ${headerClass} text-center">
                            <h5 class="mb-0 fs-6 fs-md-5">${group.isForced ? '‚ö†Ô∏è Forced ' : ''}Group ${group.groupNumber}</h5>
                        </div>
                        <div class="card-body p-3">
                            <div class="mb-2">
                                <strong class="small">Players:</strong>
                                <div class="mt-1">${group.players.map(player =>
                                    `<span class="badge skill-${player.skill.toLowerCase()} me-1 mb-1">${player.name}</span>`
                                ).join('')}</div>
                            </div>
                            ${teamsHtml}
                        </div>
                    </div>
                `;

                groupsRow.appendChild(col);
            });

            container.style.display = 'block';
            container.scrollIntoView({ behavior: 'smooth' });
        }

        // JavaScript implementation of the randomization logic
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function tryFormGroup(beginners, intermediates, advanced, groupNumber) {
            const combinations = [];

            // Beginner + Intermediate combinations
            if (beginners.length >= 1 && intermediates.length >= 3) {
                combinations.push([1, 3, 0]);
            }
            if (beginners.length >= 3 && intermediates.length >= 1) {
                combinations.push([3, 1, 0]);
            }

            // Intermediate + Advanced combinations
            if (intermediates.length >= 1 && advanced.length >= 3) {
                combinations.push([0, 1, 3]);
            }
            if (intermediates.length >= 2 && advanced.length >= 2) {
                combinations.push([0, 2, 2]);
            }
            if (intermediates.length >= 3 && advanced.length >= 1) {
                combinations.push([0, 3, 1]);
            }

            // All Intermediate
            if (intermediates.length >= 4) {
                combinations.push([0, 4, 0]);
            }

            shuffle(combinations);

            for (const combo of combinations) {
                const [bNeeded, iNeeded, aNeeded] = combo;

                if (beginners.length >= bNeeded && intermediates.length >= iNeeded && advanced.length >= aNeeded) {
                    const group = { groupNumber, players: [], isForced: false };

                    // Add players
                    for (let i = 0; i < bNeeded; i++) group.players.push(beginners.pop());
                    for (let i = 0; i < iNeeded; i++) group.players.push(intermediates.pop());
                    for (let i = 0; i < aNeeded; i++) group.players.push(advanced.pop());

                    if (isValidGroup(group.players)) {
                        return group;
                    } else {
                        // Return players
                        group.players.forEach(player => {
                            if (player.skill === 'BEGINNER') beginners.push(player);
                            else if (player.skill === 'INTERMEDIATE') intermediates.push(player);
                            else advanced.push(player);
                        });
                    }
                }
            }

            return null;
        }

        function isValidGroup(players) {
            if (players.length !== 4) return false;

            let b = 0, i = 0, a = 0;
            players.forEach(p => {
                if (p.skill === 'BEGINNER') b++;
                else if (p.skill === 'INTERMEDIATE') i++;
                else a++;
            });

            // Invalid combinations
            if (b === 2 && a === 2 && i === 0) return false;
            if (b === 2 && i === 2 && a === 0) return false;
            if (b > 0 && a > 0 && i === 0) return false;

            return true;
        }

        function randomizePlayers(players) {
            const shuffled = shuffle([...players]);

            const beginners = shuffled.filter(p => p.skill === 'BEGINNER');
            const intermediates = shuffled.filter(p => p.skill === 'INTERMEDIATE');
            const advanced = shuffled.filter(p => p.skill === 'ADVANCED');

            const groups = [];
            let groupNumber = 1;

            while (true) {
                const group = tryFormGroup(beginners, intermediates, advanced, groupNumber++);
                if (group && group.players.length === 4 && isValidGroup(group.players)) {
                    groups.push(group);
                } else {
                    if (group) {
                        // Return players
                        group.players.forEach(player => {
                            if (player.skill === 'BEGINNER') beginners.push(player);
                            else if (player.skill === 'INTERMEDIATE') intermediates.push(player);
                            else advanced.push(player);
                        });
                    }
                    break;
                }
            }

            // Handle remaining players
            const remaining = [...beginners, ...intermediates, ...advanced];
            if (remaining.length > 0) {
                const forcedGroup = { groupNumber: groupNumber, players: [], isForced: true };
                const toAdd = Math.min(4, remaining.length);
                for (let i = 0; i < toAdd; i++) {
                    forcedGroup.players.push(remaining[i]);
                }
                groups.push(forcedGroup);

                // Additional forced groups if needed
                let remainingCount = remaining.length - toAdd;
                while (remainingCount > 0) {
                    const additionalForced = { groupNumber: ++groupNumber, players: [], isForced: true };
                    const addCount = Math.min(4, remainingCount);
                    for (let i = toAdd; i < toAdd + addCount; i++) {
                        additionalForced.players.push(remaining[i]);
                    }
                    groups.push(additionalForced);
                    remainingCount -= addCount;
                }
            }

            // Split groups into teams
            groups.forEach(group => {
                if (group.players.length === 4) {
                    splitIntoTeams(group);
                }
            });

            return groups;
        }

        function splitIntoTeams(group) {
            const beginners = group.players.filter(p => p.skill === 'BEGINNER');
            const intermediates = group.players.filter(p => p.skill === 'INTERMEDIATE');
            const advanced = group.players.filter(p => p.skill === 'ADVANCED');

            shuffle(beginners);
            shuffle(intermediates);
            shuffle(advanced);

            const b = beginners.length;
            const i = intermediates.length;
            const a = advanced.length;

            group.team1 = { players: [] };
            group.team2 = { players: [] };

            if (b === 0 && a === 0 && i === 4) {
                group.team1.players = [intermediates[0], intermediates[1]];
                group.team2.players = [intermediates[2], intermediates[3]];
            } else if (b === 0 && i === 0 && a === 4) {
                group.team1.players = [advanced[0], advanced[1]];
                group.team2.players = [advanced[2], advanced[3]];
            } else if (a === 1 && b === 1 && i === 2) {
                group.team1.players = [advanced[0], beginners[0]];
                group.team2.players = [intermediates[0], intermediates[1]];
            } else if (a === 2 && b === 2 && i === 0) {
                group.team1.players = [advanced[0], beginners[0]];
                group.team2.players = [advanced[1], beginners[1]];
            } else if (a === 2 && i === 2 && b === 0) {
                group.team1.players = [advanced[0], intermediates[0]];
                group.team2.players = [advanced[1], intermediates[1]];
            } else {
                // Default balancing
                const all = shuffle([...group.players]);
                group.team1.players = [all[0], all[1]];
                group.team2.players = [all[2], all[3]];
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
